# P1803 凌乱的yyy / 线段覆盖 题解
## 题目
# P1803 凌乱的yyy / 线段覆盖

## 题目背景

**Python 用户可以尝试使用 pypy3 提交试题。**

快 noip 了，yyy 很紧张！

## 题目描述

现在各大 oj 上有 $n$ 个比赛，每个比赛的开始、结束的时间点是知道的。

yyy 认为，参加越多的比赛，noip 就能考的越好（假的）。

所以，他想知道他最多能参加几个比赛。

由于 yyy 是蒟蒻，如果要参加一个比赛必须善始善终，而且不能同时参加 $2$ 个及以上的比赛。

## 输入格式

第一行是一个整数 $n$，接下来 $n$ 行每行是 $2$ 个整数 $a_{i},b_{i}\ (a_{i}<b_{i})$，表示比赛开始、结束的时间。

## 输出格式

一个整数最多参加的比赛数目。

## 输入输出样例 #1

### 输入 #1

```
3
0 2
2 4
1 3
```

### 输出 #1

```
2
```

## 说明/提示

- 对于 $20\%$ 的数据，$n \le 10$；
- 对于 $50\%$ 的数据，$n \le 10^3$；
- 对于 $70\%$ 的数据，$n \le 10^{5}$；
- 对于 $100\%$ 的数据，$1\le n \le 10^{6}$，$0 \le a_{i} < b_{i} \le 10^6$。



## 题目分析

这是一道经典的**区间调度问题**，也被称为**活动选择问题**。题目要求在给定的n个时间区间中，选择尽可能多的不重叠区间。

### 问题本质
- 每个比赛可以看作时间轴上的一个线段/区间 [start, end)
- 两个区间不重叠的条件：一个区间的结束时间 ≤ 另一个区间的开始时间
- 目标：选择最多数量的互不重叠区间

## 坐标系分析

我们可以将这个问题在坐标系中可视化：

```
时间轴: 0----1----2----3----4----5----6
区间1:  [-----)           (0,2)
区间2:        [-----)     (2,4)  
区间3:     [-----)        (1,3)
```

从坐标系角度看：
- 每个区间是时间轴上的一个线段
- 区间1和区间2不重叠（区间1在时间2结束，区间2在时间2开始）
- 区间1和区间3重叠（在时间1-2之间有交集）
- 区间2和区间3重叠（在时间2-3之间有交集）

最优选择是区间1和区间2，总共2个区间。

## 算法思路

### 贪心策略
这是一个经典的贪心算法问题。关键思想是：**按结束时间排序，优先选择结束时间早的区间**。

**为什么按结束时间排序？**
- 结束时间越早的区间，为后续区间留下的空间越大
- 这样能最大化可选择的区间数量

### 算法步骤
1. 将所有区间按结束时间从小到大排序
2. 选择第一个区间（结束时间最早）
3. 遍历剩余区间，如果当前区间的开始时间 ≥ 上一个选中区间的结束时间，则选择该区间
4. 重复步骤3，直到遍历完所有区间

## 算法正确性证明

### 贪心选择性质
假设存在一个最优解S，其中第一个选择的区间不是结束时间最早的区间。设结束时间最早的区间为A，S中第一个区间为B。

由于A的结束时间 ≤ B的结束时间，我们可以将S中的B替换为A，得到新解S'。S'仍然是可行解（因为A结束得更早，不会与后续区间产生新的冲突），且S'的区间数量等于S。

因此，总存在一个以结束时间最早区间开始的最优解。

### 最优子结构
选择了结束时间最早的区间后，剩余问题变成：在所有开始时间 ≥ 该区间结束时间的区间中，选择最多的不重叠区间。这是一个相同结构的子问题。

## 复杂度分析

- **时间复杂度**：O(n log n)，主要消耗在排序上
- **空间复杂度**：O(n)，存储区间信息

## 总结

这道题是区间调度问题的经典应用，核心思想是贪心算法：
1. **按结束时间排序**是关键
2. **贪心选择**：优先选择结束时间早的区间
3. 该贪心策略能保证全局最优解

这类问题在实际生活中很常见，比如会议室安排、任务调度等，都可以用相同的思路解决。
