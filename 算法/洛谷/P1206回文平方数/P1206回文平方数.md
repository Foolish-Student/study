# P1206 [USACO1.2] 回文平方数 Palindromic Squares

## 题目描述

回文数是指从左向右念和从右向左念都一样的数。如 $12321$ 就是一个典型的回文数。

给定一个用十进制表示的正整数 $B$，输出所有 $[1,300]$ 中，它的平方用 $B$ 进制表示时是回文数的数。

## 输入格式

共一行，一个单独的正整数 $B$。

## 输出格式

每行两个 $B$ 进制的符合要求的数字，第二个数是第一个数的平方，且第二个数是回文数。

注意大于 $9$ 的数，用字母表示。如用 `A` 表示 $10$，`B` 表示 $11$，用第 $n$ 个大写字母表示 $n+9$。

## 输入输出样例 #1

### 输入 #1

```
10
```

### 输出 #1

```
1 1
2 4
3 9
11 121
22 484
26 676
101 10201
111 12321
121 14641
202 40804
212 44944
264 69696
```

## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$2 \le B \le 20$

题目翻译来自NOCOW。

USACO Training Section 1.2

---

## 题解

### 🎯 题目分析

这道题要求我们找出所有在1到300范围内的数字，使得它们的平方在给定进制B下表示为回文数。

**核心问题分解：**
1. 对于每个数字i (1 ≤ i ≤ 300)，计算i²
2. 将i²转换为B进制表示
3. 判断B进制表示是否为回文数
4. 如果是回文数，输出i的B进制表示和i²的B进制表示

### 💡 解题思路

#### 1. 进制转换
将十进制数转换为B进制的标准算法：
- 不断对B取余，得到的余数就是B进制的各位数字（从低位到高位）
- 用字符数组 `"0123456789ABCDEFGHIJ"` 来表示0-19的数字

#### 2. 回文判断
对于一个字符串，回文的定义是：
- 第i个字符等于第(n-1-i)个字符（其中n是字符串长度）
- 只需要检查前半部分即可


**注意事项：**
- 特殊处理0的情况
- 通过在字符串前面插入字符来保证高位在前
- 使用字符数组映射数字到字符


**要点：**
- 只需要检查前半部分字符
- 第i个字符与第(len-1-i)个字符比较
- 任何一对不匹配就返回false

### 📊 复杂度分析

**时间复杂度：** O(300 × log_B(300²) × log_B(300²)) = O(300 × (log_B(90000))²)
- 外层循环300次
- 每次进制转换需要O(log_B(num))时间
- 回文判断需要O(log_B(num))时间

**空间复杂度：** O(log_B(300²)) = O(log_B(90000))
- 主要是存储B进制字符串的空间

### ⚠️ 易错点提醒

1. **进制转换的顺序**
   - 取余得到的是从低位到高位的数字
   - 需要注意字符串构建的顺序，确保高位在前

2. **字符映射**
   - 0-9用数字字符表示
   - 10-19用A-J表示
   - 确保字符数组的索引正确

3. **边界条件**
   - 数字0的特殊处理
   - 确保进制B在有效范围内(2 ≤ B ≤ 20)

4. **输出格式**
   - 每行输出两个数：原数的B进制表示 + 空格 + 平方数的B进制表示
   - 注意换行符的使用

### 🌟 算法优化建议

1. **字符串构建优化**
   - 可以先构建reverse字符串，最后再reverse，避免频繁的字符串前插操作

2. **预计算优化**
   - 可以预先计算所有需要的平方数，避免重复计算

3. **内存优化**
   - 使用`reserve()`为字符串预分配空间

### 🎯 总结

这道题是一个典型的**进制转换 + 字符串处理**问题，核心考察：
- 数字进制转换的实现
- 回文字符串的判断
- 字符映射和字符串操作

解决这类问题的关键是要理清楚进制转换的过程，确保字符串的构建顺序正确，以及回文判断的逻辑准确。