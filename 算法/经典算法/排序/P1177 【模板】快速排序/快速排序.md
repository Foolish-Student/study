# 快速排序（QuickSort）思路笔记

## 1. 核心思想

快速排序是一种**分治思想**（Divide and Conquer）排序算法。核心步骤是：

1. **选择枢轴（Pivot）**：从数组中选一个值作为划分基准；
2. **划分（Partition）**：将小于枢轴的元素放在左边，大于枢轴的元素放在右边；
3. **递归排序**：对左右两部分分别递归进行同样的操作。

---

## 2. 步骤解析

### 2.1 选择枢轴

* 可以选择第一个元素、最后一个元素、随机一个元素，或者三数取中（first、middle、last 取中间值）。
* **随机枢轴**或**三数取中**可以有效降低退化到 O(n²) 的概率。

### 2.2 双指针划分

* 使用两个指针 `l` 和 `r`，分别从区间两端向中间移动。
* 从右边开始寻找**第一个小于枢轴**的元素，从左边开始寻找**第一个大于枢轴**的元素，然后交换它们。
* 当 `l` 与 `r` 相遇时，划分完成，枢轴放回中间位置。

### 2.3 递归处理

* 左区间范围：`[left, pivotIndex - 1]`
* 右区间范围：`[pivotIndex + 1, right]`
* 递归终止条件：区间长度 ≤ 1 时，不再排序。

---

## 3. 时间复杂度分析

* **平均时间复杂度**：O(n log n)
* **最坏时间复杂度**：O(n²)（当每次划分极不平衡，如数组已经有序）
* **空间复杂度**：O(log n)（递归栈）

---

## 4. 优化策略

1. **随机化枢轴**：在递归前先随机打乱数组，减少最坏情况出现概率。
2. **三数取中**：用三个位置的值（头、中、尾）选出中间值作为枢轴。
3. **小区间优化**：当子区间元素数量很小时，可以切换到插入排序提高性能。
4. **尾递归优化**：减少递归栈深度，避免栈溢出。

---

## 5. 特点总结

* **不稳定排序**（相同元素的相对位置可能改变）。
* **原地排序**（只需少量额外空间）。
* **在平均情况下是最快的比较排序算法之一**。
* 对于大规模数据特别高效，但需注意枢轴选择策略以避免退化。

---
