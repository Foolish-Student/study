# JZ71 题解｜跳台阶扩展问题（重点讲清状态转移）

## 题目概述

* **规则**：一次可以跳 `1..n` 级（任意正整数步长）。
* **目标**：到达第 `n` 级的不同跳法总数。
* **数据范围**：`1 ≤ n ≤ 20`。
* **要求**：期望 **O(1)** 空间、**O(1)** 时间（可通过数学化简实现）。

---

## 一、建模：从“第一跳”出发的划分

设 `f(n)` 为上到 `n` 级的方案数。考虑**第一跳跳了多少级**：

* 若第一跳跳了 `k` 级（`1 ≤ k ≤ n`），后面还剩 `n-k` 级要爬，其方案数是 `f(n-k)`。
* 第一跳的 `k` 可以取遍 `1..n`，且互斥覆盖所有方案。

于是得到最直接的**加和型递推**：

> **`f(n) = f(n-1) + f(n-2) + … + f(1) + f(0)`**
> 为了让式子在 `n=k` 时成立，需要定义 **`f(0)=1`**（“已经在顶层”的空方案，计作 1 种）。

**边界**：

* `f(0)=1`（定义）
* `f(1)=1`（只能跳 1 级）

---

## 二、关键化简：从“加和所有前项”到“翻倍上一项”

把上式写成前缀和形式：

* `f(n) = f(n-1) + f(n-2) + … + f(0)`
* `f(n-1) = f(n-2) + … + f(0)`

两式相减：

> `f(n) - f(n-1) = f(n-1)`
> **⇒ `f(n) = 2 * f(n-1)`**

这就是本题最重要的**状态转移方程**：

> **`f(n) = 2 f(n-1)`，`f(1)=1`**

顺推可得闭式：

> **`f(n) = 2^(n-1)`**

---

## 三、组合学直觉（等价证明）

把 `n` 级台阶视为 `n` 个单位台阶中间的 `n-1` 个“缝隙”。
每一种跳法，本质是把这 `n` 个单位台阶**分组**（每组一次跳完）。
对于每一条缝隙，你有两种选择：**“不断开”（与前一台阶合并）**或**“断开”（作为新的一跳起点）**。

* 共 `n-1` 条缝隙，每条缝隙 2 种选择 → **`2^(n-1)`** 种方案。
  这与上面的递推化简结果完全一致。

---

## 四、与常规跳台阶（JZ69）的对比

* **JZ69**：只能跳 1 或 2 ⇒ `f(n)=f(n-1)+f(n-2)`（斐波那契型）。
* **JZ71**：能跳 1..n ⇒ `f(n)=∑_{k=0}^{n-1} f(k)` ⇒ **`f(n)=2 f(n-1)`**（翻倍型）。
* 能力更强（步长更自由），增长更快（指数倍）。

---

## 五、复杂度与实现提示

* 由于有闭式 **`f(n)=2^(n-1)`**，可 **O(1)** 计算；
* 在给定范围 `n ≤ 20` 下，`2^(n-1) ≤ 2^19 = 524,288`，用 `int` 足够；
* 若用 DP 滚动求，也只需两个变量维护（但已无必要）。

---

## 六、样例速验

* `n=1`：`2^(0)=1` ✅
* `n=3`：`2^(2)=4`（与示例一致）✅
* `n=5`：`2^(4)=16` ✅

---

## 一页纸总结

* **递推**：`f(n)=∑_{k=0}^{n-1} f(k)`，`f(0)=1`
* **化简**：`f(n)=2 f(n-1)`，`f(1)=1`
* **闭式**：`f(n)=2^(n-1)`（**O(1)** 时间空间）
* **直觉**：在 `n-1` 条缝隙上做二元选择（断/不断），共有 `2^(n-1)` 种分组方式。
