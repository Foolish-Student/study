# 166：分数到小数（Fraction to Decimal）

## 题目概述

* 输入两个整数：`numerator`（分子）和 `denominator`（分母）
* 返回分数 `numerator/denominator` 对应的小数表示，字符串形式
* 如果小数部分为循环小数，则用括号标记循环部分
* 保证输入有效，分母不为 0，输出长度小于 10⁴

### 示例

1. `numerator = 1, denominator = 2` → `"0.5"`
2. `numerator = 2, denominator = 1` → `"2"`
3. `numerator = 4, denominator = 333` → `"0.(012)"`

---

## 解题思路

### 1️⃣ 处理符号和整数部分

* 首先确定结果的符号：

  * 分子和分母符号不同 → 结果为负
  * 分子和分母符号相同 → 结果为正
* 计算整数部分：

  * 用 **整除** 计算整数部分
  * 如果整除没有余数 → 返回整数部分即可

---

### 2️⃣ 处理小数部分

* 对余数进行处理，逐位生成小数：

  1. 将余数乘以 10
  2. 除以分母得到当前小数位
  3. 取余数更新下一轮

* 关键点：**循环检测**

  * 使用哈希表记录每个余数第一次出现的位置
  * 如果某个余数再次出现 → 小数开始循环
  * 在结果字符串中插入括号，标记循环部分

---

### 3️⃣ 循环小数识别原理

* 小数循环的本质是 **余数重复**
* 每次计算小数位时：

  * 余数 = 当前被除数 % 分母
  * 将余数存入 map，并记录结果字符串的索引
  * 如果余数再次出现 → 循环开始
* 例如：`4 / 333`

  * 小数位按余数生成 `"012012..."`
  * 第一次余数重复时标记 `"0.(012)"`

---

### 4️⃣ 特殊情况

* 分子能整除分母 → 直接返回整数
* 小数部分非循环 → 余数最终为 0
* 符号处理要在生成小数前完成
* 使用 `long long` 避免溢出

---

### 5️⃣ 总结流程

1. 判断符号 → 确定正负号
2. 计算整数部分 → `numerator / denominator`
3. 处理小数部分：

   * 用哈希表追踪余数
   * 余数重复 → 循环，插入括号
   * 余数为 0 → 小数终止
4. 拼接整数部分、小数点、小数位 → 得到最终字符串

---

## 核心思想

* **循环检测** → 哈希表存余数
* **整数和小数拆分处理** → 防止负数和溢出
* **动态构造字符串** → 插入括号标记循环

> 本质是 **长除法模拟 + 余数记录**，通过哈希表实现循环小数检测。
