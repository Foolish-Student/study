# 2.4 Agent 的核心技能：调用工具（重点梳理）

## 1️⃣ 为什么“调用工具”是核心技能？

* 只靠大模型本身，Agent **只能生成文本**，做不到：

  * 查最新数据（今天的订单、股价、库存）
  * 操作业务系统（建任务、改状态、发邮件）
  * 进行复杂计算或执行代码
* 一旦接上工具（API / 数据库 / 脚本 / 外部服务），Agent 才能：

  * 访问实时、私有的数据
  * 真正**改变外部世界的状态**（不仅是给建议，而是把事办了）

👉 所以“调用工具”就像给 Agent 装上“手脚”，是从“聊天模型”进化成“能干活的智能体”的关键一步。

---

## 2️⃣ 工具大概分哪几类？

可以按功能大致分几种常见类型（书里典型场景也是围绕这些展开的）：

1. **信息/数据类工具**

   * 内外部搜索引擎、知识库检索、向量数据库
   * 业务查询接口（查订单、查用户、查工单、查库存……）
     👉 解决“我现在不知道，但我可以去查”的问题。

2. **计算/代码执行工具**

   * 计算引擎、Python/SQL 执行环境、数值/统计库
     👉 解决“我会推理，但复杂计算需要真正跑一下”的问题。

3. **业务系统 & 自动化工具**

   * CRM、工单系统、项目管理系统、邮件/日程、RPA 等接口
     👉 让 Agent 能“点系统”“改配置”“发通知”“生成和存文件”。

4. **外部服务/设备工具**

   * 支付、地图、物流、IoT 设备、机器人控制等
     👉 让 Agent 从“数字世界”伸手到“物理世界”。

---

## 3️⃣ 一次“工具调用”的典型闭环

大概可以记成这 5 步（这也是书里围绕 OpenAI Functions / Tool Calls 一类能力讲的常见流程）：

1. **理解意图**

   * 大模型先理解：用户到底要什么？
   * 决定：仅用推理就能回答，还是需要查数据/动系统。

2. **选择工具 & 生成调用**

   * 在可用工具列表中挑一个（或一组）合适的工具；
   * 按工具约定的参数结构生成调用请求（相当于“自动写好函数调用”).

3. **执行工具**

   * 由宿主程序/平台实际去调 API / 数据库 / 脚本；
   * 拿回结果（数据 / 状态 / 报错信息）。

4. **解析结果 & 继续推理**

   * 大模型把工具返回值读懂、总结、和当前上下文合并；
   * 再判断：任务是否完成？需不需要继续调用其他工具？

5. **输出最终结果 / 继续行动**

   * 给用户一个可读的答案、报告或执行确认；
   * 或继续自动推进后续子任务（例如再发一封邮件、再建一个任务）。

👉 这就是“ReAct + Tool Calling”背后的实际工作流：**思考 ↔ 调工具 ↔ 看结果 ↔ 再思考** 的循环。

---

## 4️⃣ 设计工具调用时要特别注意的点

重点不是“工具越多越好”，而是“接口定义清晰、边界安全、可观测”。

1. **接口清晰、描述到位**

   * 每个工具要有明确的：

     * 功能说明（做什么）
     * 入参字段（各字段含义、类型、范围）
     * 返回结果结构
   * 这样大模型才“看得懂”“调得对”。

2. **权限与安全边界**

   * 工具能做什么、不能做什么要提前设计好；
   * 涉及写操作（删数据、付款、发指令）的工具，要加限制和人工审核机制。

3. **容错与重试机制**

   * 网络失败、参数不合法、返回空结果，都要有处理逻辑；
   * 大模型要能根据错误信息调整参数、换工具或请求人工干预。

4. **配合规划和记忆使用**

   * 规划模块：决定**工具调用的顺序和依赖关系**；
   * 记忆模块：记录历史工具调用和关键结果，避免重复踩坑，让后续步骤有“上下文”。

---

## 5️⃣ 一句话记住 2.4 的核心

> **调用工具 = Agent 的“执行手段”，
> 它把大模型的理解与推理能力，转化为“查得到最新数据、改得动现实系统、跑得起完整流程”的真正行动力。**
