# **第34条：了解哪些算法要求使用排序区间**

## **核心思想**

* STL 中一些算法要求 **输入区间已排序**，否则结果不可靠。
* 这些算法大多与 **查找、集合操作、合并** 有关。
* 使用前必须确保区间排序，否则逻辑错误或返回位置不正确。

---

## **1️⃣ 查找相关算法**

### 1.1 `std::binary_search`

* **功能**：判断目标元素是否存在
* **要求**：区间 **升序**（默认 `<` 比较）
* **特点**：

  * 返回 `bool`
  * 不返回元素位置，只返回存在/不存在
* **示例**：

```cpp
std::vector<int> v = {1,3,5,7,9};
bool exists = std::binary_search(v.begin(), v.end(), 5); // true
```

* **注意**：区间未排序 → 结果不可靠

---

### 1.2 `std::lower_bound`

* **功能**：返回 **第一个不小于目标元素的迭代器**
* **要求**：区间升序
* **用途**：

  * 找到目标元素或插入位置
  * 可配合 `erase-remove` 或插入操作

```cpp
auto it = std::lower_bound(v.begin(), v.end(), 5); // 指向 5
```

* **返回值特点**：

  * 如果存在目标元素 → 指向第一个等于它的位置
  * 如果不存在 → 指向第一个大于目标的位置

---

### 1.3 `std::upper_bound`

* **功能**：返回 **第一个大于目标元素的迭代器**
* **要求**：区间升序
* **用途**：

  * 找到目标元素的上界
  * 常用于计算区间内元素出现次数

```cpp
auto it = std::upper_bound(v.begin(), v.end(), 5); // 指向第一个 >5 的位置
```

* **返回值特点**：

  * 如果元素存在 → 指向第一个大于目标的位置
  * 如果元素不存在 → 指向第一个大于目标的元素或末尾

---

### 1.4 `std::equal_range`

* **功能**：返回一个 pair，包含目标元素的 **下界和上界**
* **用途**：

  * 直接获取目标元素在区间的范围
  * 可用于统计元素出现次数：`count = upper - lower`

```cpp
auto range = std::equal_range(v.begin(), v.end(), 5);
int count = range.second - range.first;
```

---

## **2️⃣ 合并与集合操作**

* **`std::merge`**：合并两个排序区间到新容器
* **`std::set_union` / `set_intersection` / `set_difference` / `set_symmetric_difference`**：集合操作
* **要求**：输入区间 **各自排序**
* **特点**：结果逻辑正确且高效

---

## **3️⃣ 总结规律**

1. **排序区间必须保证升序**（或自定义比较器一致）
2. **查找算法**：

   * `binary_search` → 是否存在
   * `lower_bound` → 第一个 ≥ target
   * `upper_bound` → 第一个 > target
   * `equal_range` → 返回目标元素范围
3. **集合/合并算法**：

   * 两个区间各自排序 → merge 或 set 操作

---

💡 **一句口诀**：

> **“二分找存在，lower 找下界，upper 找上界，equal\_range 得范围，合并集合要排好序。”**
