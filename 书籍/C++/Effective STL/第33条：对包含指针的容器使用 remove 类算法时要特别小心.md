# **ç¬¬33æ¡ï¼šå¯¹åŒ…å«æŒ‡é’ˆçš„å®¹å™¨ä½¿ç”¨ `remove` ç±»ç®—æ³•æ—¶è¦ç‰¹åˆ«å°å¿ƒ**

## **æ ¸å¿ƒæ€æƒ³**

* å¦‚æœå®¹å™¨ä¸­å­˜æ”¾çš„æ˜¯ **åŸå§‹æŒ‡é’ˆï¼ˆraw pointerï¼‰**ï¼Œä¾‹å¦‚ï¼š

```cpp
std::vector<Foo*> v;
```

* ä½¿ç”¨ `std::remove` / `std::remove_if` **åªä¼šç§»åŠ¨æŒ‡é’ˆæœ¬èº«**ï¼Œå¹¶ä¸ä¼šé‡Šæ”¾æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡ã€‚

> æ¢å¥è¯è¯´ï¼Œ`remove` ä»…æ”¹å˜å®¹å™¨å†…æŒ‡é’ˆçš„ä½ç½®ï¼Œè€Œä¸ä¼šè°ƒç”¨ `delete` æˆ–ææ„å¯¹è±¡ã€‚

---

## **1ï¸âƒ£ å…¸å‹é—®é¢˜**

```cpp
std::vector<Foo*> v = {new Foo, new Foo, new Foo};
auto new_end = std::remove(v.begin(), v.end(), v[0]);
v.erase(new_end, v.end());
```

* `v[0]` æŒ‡é’ˆè¢«ç§»å‡ºå®¹å™¨
* **å¯¹è±¡ä»ç„¶åœ¨å †ä¸Šå­˜åœ¨** â†’ å†…å­˜æ³„æ¼
* å¦‚æœä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚ `std::unique_ptr`ï¼‰åˆ™ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œä½†åŸå§‹æŒ‡é’ˆå¿…é¡»æ‰‹åŠ¨ delete

---

## **2ï¸âƒ£ å®‰å…¨åšæ³•**

### 2.1 åˆ é™¤å¯¹è±¡ + ç§»é™¤æŒ‡é’ˆ

```cpp
for (Foo* p : v) {
    if (/* p éœ€è¦åˆ é™¤ */) delete p;
}
v.erase(
    std::remove(v.begin(), v.end(), /* æŒ‡é’ˆ */),
    v.end()
);
```

* å…ˆé‡Šæ”¾å¯¹è±¡
* å†è°ƒç”¨ `erase-remove` åˆ é™¤æŒ‡é’ˆ

### 2.2 ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ

* ä½¿ç”¨ `std::unique_ptr<Foo>` æˆ– `std::shared_ptr<Foo>` æ›¿ä»£åŸå§‹æŒ‡é’ˆ
* `remove` + `erase` ä¼šè‡ªåŠ¨é‡Šæ”¾å¯¹è±¡ï¼Œæ— éœ€æ‰‹åŠ¨ delete

```cpp
std::vector<std::unique_ptr<Foo>> v;
// erase-remove è‡ªåŠ¨è°ƒç”¨ææ„
v.erase(
    std::remove_if(v.begin(), v.end(),
        [](const std::unique_ptr<Foo>& p){ return æ¡ä»¶; }),
    v.end()
);
```

* å®‰å…¨ä¸”ä¸æ˜“å‡ºé”™

---

## **3ï¸âƒ£ å¸¸è§è¯¯åŒº**

| é”™è¯¯åšæ³•                                             | é—®é¢˜                                                     |
| ------------------------------------------------ | ------------------------------------------------------ |
| `std::remove(v.begin(), v.end(), p)` åç›´æ¥ `erase` | ä»…åˆ é™¤æŒ‡é’ˆï¼Œ**ä¸ä¼š delete å¯¹è±¡** â†’ å†…å­˜æ³„æ¼                          |
| å¯¹æ™ºèƒ½æŒ‡é’ˆä¸ç†è§£ `remove` è¡Œä¸º                             | å¯¹ `std::unique_ptr` æ‰§è¡Œ remove + erase æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºå¯¹è±¡ææ„ä¼šè‡ªåŠ¨è°ƒç”¨ |

---

## **4ï¸âƒ£ æ ¸å¿ƒæ€»ç»“**

1. **åŸå§‹æŒ‡é’ˆå®¹å™¨ + remove** â†’ å®¹å™¨æŒ‡é’ˆç§»åŠ¨ï¼Œå †å¯¹è±¡ä»åœ¨ â†’ å¯èƒ½å†…å­˜æ³„æ¼
2. **å¤„ç†æ–¹æ³•**ï¼š

   * æ‰‹åŠ¨ delete å¯¹è±¡ï¼Œå† erase æŒ‡é’ˆ
   * ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
3. **erase-remove é€‚ç”¨åœºæ™¯**ï¼š

   * è¿ç»­å®¹å™¨ï¼ˆvectorã€dequeã€stringï¼‰
   * éæŒ‡é’ˆå…ƒç´ æ›´å®‰å…¨

---

ğŸ’¡ **ä¸€å¥å£è¯€**

> **â€œremoveåªæ¬æŒ‡é’ˆï¼Œææ„éœ€è‡ªå·±åŠ¨ï¼›æ™ºèƒ½æŒ‡é’ˆä¿å®‰å…¨ï¼Œerase-removeæ›´æ”¾å¿ƒã€‚â€**
