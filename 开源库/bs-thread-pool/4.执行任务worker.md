# 执行任务
## 初始化
```cpp
init_func(idx);
```
在构造线程池的时候，第二个参数是一个函数，对应着这里init_func函数。线程工作会执行初始化函数

## 工作循环
```cpp
while (true)
```
线程中使用`while`循环持续工作，直到线程池销毁

## 通知等待线程
```cpp
if constexpr (pause_enabled)
{
    if (waiting && (tasks_running == 0) && (paused || tasks.empty()))
        tasks_done_cv.notify_all();
}
else
{
    if (waiting && (tasks_running == 0) && tasks.empty())
        tasks_done_cv.notify_all();
}
```
当所有任务完成时，通知调用`wait()`的主线程

## 等待条件
```cpp
task_available_cv.wait(tasks_lock,
    [this]
    {
        if constexpr (pause_enabled)
            return !(paused || tasks.empty()) || !workers_running;
        else
            return !tasks.empty() || !workers_running;
    });
```

等待条件：有任务可执行 或 线程池要关闭

## 执行任务
```cpp
task_t task = pop_task(); 
++tasks_running;
tasks_lock.unlock();

try
{
    task();
}
catch (...)
{
}
```

1. 从队列取出任务
2. 增加运行任务计数
3. 释放锁后执行任务
4. 异常安全处理